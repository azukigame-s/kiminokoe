# キミノコエ - 開発概要書

失った記憶を、声で辿るアドベンチャー＆ノベルゲーム

---

## 1. ゲーム概要

### コンセプト
主人公が故郷「地蔵焚（じぞうだき）」に戻り、弟スグの命日を訪れる中で、混濁した記憶を辿っていくノベルゲーム。「声」をテーマとした多層のミスリードと、最後のカタルシスを目指す。

### コアミスリード（開発者のみ知るべき情報）

**ミスリード①: 主人公の声**
- 主人公はスグの事故のショックで声を失っている
- プレイヤーには最後まで気づかせない
- 家族・親戚は手話を覚えている
- 地の文で「伝えた」「応えた」と書くことでミスリード
- お寺さんは手話を知らないため、頷くだけの対応

**ミスリード②: キミノコエの意味**
- プレイヤーは「スグの声」だと思う
- 実は「自分の声（失った声）」でもある
- エンディングで「声に出して」と明かされる

**ミスリード③: 白い服の少年（2人存在）**
- 実在する少年: イロが知り合いの子供に頼んでスグのふりをさせた（エンディング後のマル秘ストーリーで明かされる）
- 霊体の少年: スグの霊体。エピソード後に姿が見える（一部のエピソードのみ）
- プレイヤーには同一人物に見せかける

**ミスリード④: 記憶の混濁**
- ep_0は歪んだ記憶（喧嘩したまま事故へ）
- ep_0_βが真実（仲直りしていた、誕生日を楽しみにしていた）
- 罪悪感が記憶を歪めた
- 全プレイ後にep_0がep_0_βに切り替わる

---

## 2. キャラクター

| キャラクター | 関係 | 特徴 |
|-------------|------|------|
| 主人公 | 兄 | 声を失っている。記憶が混濁している |
| スグ | 弟 | 8歳で事故で亡くなった。野球好き |
| イロ | 妹 | 中学2年生。天真爛漫。手話を知っている |
| 祖母 | 祖母 | 岡山方言を使う。手話を知っている |
| 父 | 父 | あまり登場しない。手話を知っている |
| 叔父 | 叔父 | スグを自分の子のように思っていた。手話を知っている |
| 親戚のおじさん | 親戚 | テンションが高い。バルーンアート。手話を知っている |
| お寺さん | 住職 | よそ者だが村を愛している。研究熱心。手話を知らない |

---

## 3. シナリオ構成

### 時系列

```
10月10日（弟の命日）
├── 15:00 バス停・地下道（実在する少年に遭遇）
├── 15:30 実家到着
├── 16:00 自由時間（4方向の探検）
│   ├── 北（海）→ 岩場 or 海水浴場
│   │   ├── 岩場 → ep_5「捨て猫」（霊体なし）
│   │   └── 海水浴場 → ep_2「海」（霊体あり）
│   ├── 東（湧き水）→ ep_6「沢蟹」（霊体なし）+ 童歌
│   ├── 南（お寺）→ 秘密基地（EP無し・重要な場所として温存）
│   └── 西（バス停）→ ep_1「カード」（霊体あり）
└── 夕食

10月11日（法事当日）
├── 15:00 法要・お寺さんとの会話
└── 19:00 会食（叔父/親戚のおじさん/イロとの会話）

10月12日
└── （未完成：残りのエピソード・秘密基地のラストシーン・エンディング前イベント）

エンディング
└── キミノコエ（トゥルーエンド）
```

### エピソード一覧

| エピソード | タイトル | 内容 | 霊体 | 状態 |
|-----------|---------|------|------|------|
| ep_0 | 命日 | 喧嘩バージョン（歪んだ記憶） | - | 完成 |
| ep_0_β | 命日 | 仲良しバージョン（真実） | - | 完成 |
| ep_1 | カード | キラカードを弟に渡す | ✓ | 完成 |
| ep_2 | 海 | 波に揉まれ弟に助けられる | ✓ | 完成 |
| ep_3 | バス停 | 冬の待ちぼうけ、コートを貸す | × | 完成（呼び出し場所未決） |
| ep_4 | キャッチボール | 弟の悩みを解決する | × | 完成（呼び出し場所未決） |
| ep_5 | 捨て猫 | 4人で捨て猫を救う | × | 完成 |
| ep_6 | 沢蟹 | （未著述） | × | 未完成 |

### 霊体の描写パターン（エピソード後）

霊体が見えるエピソード（ep_1, ep_2）のみに配置。

描写のポイント：
- 半透明、ぼんやり、輪郭が曖昧
- 場所の特徴に合わせた比喩（波の泡、夕暮れの光など）
- 目をこすると/瞬きをすると消える
- その後「スグだったのだろうか」という不確かな反応

霊体が見えないエピソード（ep_3, ep_4, ep_5, ep_6）は、温かい思い出として自然に終わる。

### 記憶の混濁の表現

シナリオ各所に「思い出せない」「霞んでいる」「違和感がある」を散らばせている。

- 梨のシーン: 「スグはこの梨が好きだっただろうか？――思い出せない」
- 地下道: 「白い服の少年――どこかで見たような気がする。でも、思い出せなかった」
- 叔父との会話: 「正直あまり記憶になかった」
- エピソード後: 「でも――なんだろう……。その違和感がぬぐい切れなかった」

### 童歌「ふたこじぞう」

```
じぞうさま　じぞうさま
どちらの子が　ピーヒョロロ
ひび割れた　ひび割れた
あたまおなか　手とあし
ぱちぱち燃えたら
川へゆく　川へゆく
```

- 「ピーヒョロロ」= 鳶の鳴き声（プロローグと呼応）
- 意味の解説はプレイヤーに考察させる
- 東（湧き水）のルートで、おばあさんが口ずさんでいて発見される

---

## 4. 地蔵焚の設定

### 村の構成
- 北に海、南に山
- 実家が村の真ん中
- 東西南北に道が伸びる

### 重要な場所
- **兄の水**: 東側の清流（軟水）
- **弟の水**: 西側の清流（硬水）
- 二筋の川は古い『しきたり』で地蔵を流す場所だった
- **お寺の裏の大きな木**: 秘密基地。物語の重要な場所として温存
- **高台の空き地**: かつての商店の跡地（深い意味はない）
- **焚き場の跡**: 別途登場予定

### しきたり（裏設定）
- 兄弟それぞれが小さな地蔵を持つ
- 兄弟が同時に病むと、どちらかの地蔵を囲炉裏で焚べる
- 罅の入った部分が「引き受けた病の場所」
- 燃やした地蔵は川に流す
- やがて「大きな災いを無数の小さな痛みに分ける」ことに気づき、毎晩誰かが地蔵を焚べるようになった
- 今では忘れ去られている

---

## 5. 技術仕様

### プロジェクト構成
```
kiminokoe/
├── assets/                    # リソースファイル
│   ├── backgrounds/          # 背景画像
│   ├── fonts/                # フォント
│   ├── music/                # BGM
│   └── sounds/               # 効果音
├── scenarios/                # シナリオファイル（JSON）
│   ├── main.json
│   ├── days/
│   ├── branches/
│   └── episodes/
├── scenes/                   # シーンファイル
├── scripts/                  # GDScriptスクリプト
├── shaders/                  # シェーダー
└── themes/                   # テーマ
```

### シナリオJSON記法のコマンド対応

| コマンド | 機能 |
|---------|------|
| dialogue | テキスト表示 |
| background | 背景変更 |
| bgm | BGM再生 |
| sfx | 効果音再生 |
| subtitle | サブタイトル表示 |
| choice | 選択肢表示 |
| load_scenario | 別シナリオ読み込み |
| jump | インデックスジャンプ |
| flashback_start | 回想モード開始（グレースケール） |
| flashback_end | 回想モード終了 |
| episode_clear | エピソードクリア記録 |
| index | インデックスマーカー |

### 実装済み機能
1. テキスト表示（タイプライター効果、ページバッファ）
2. 背景システム（フェード、回想モード）
3. 音声システム（BGM/SFX）
4. 選択肢システム（マウス/キーボード対応）
5. サブタイトルシステム
6. シナリオシステム（JSON読み込み、スタック、キャッシュ）
7. スキップ機能
8. トロフィーシステム
9. シーン管理（タイトル/設定/ゲーム画面）
10. 設定システム（テキスト速度、音量、フルスクリーン）

### シナリオJSON記法サンプル

```json
[
  // 背景変更
  {"type": "background", "path": "res://assets/backgrounds/busstop.jpg"},

  // テキスト表示（新ページ開始）
  {"type": "dialogue", "text": "テキスト本文。", "new_page": true},

  // テキスト表示（同じページに追加）
  {"type": "dialogue", "text": "続きのテキスト。"},

  // テキスト表示後に自動で次へ進む
  {"type": "dialogue", "text": "このテキストの後は自動で次へ。", "go_next": true},

  // サブタイトル表示
  {"type": "subtitle", "text": "15:00", "fade_time": 0.5, "display_time": 2.0},

  // 効果音
  {"type": "sfx", "path": "res://assets/sounds/bang_sfx.mp3"},

  // BGM
  {"type": "bgm", "path": "res://assets/music/sample_bgm.mp3"},

  // 選択肢
  {
    "type": "choice",
    "choices": [
      {"id": "choice_a", "text": "選択肢A", "next_index": 400},
      {"id": "choice_b", "text": "選択肢B", "next_index": 500}
    ]
  },

  // インデックスマーカー（jampの遷移先）
  {"type": "index", "index": 400},

  // インデックスジャンプ（分岐後の合流点へ）
  {"type": "jump", "index": 600},

  // 別シナリオ読み込み（読み込んだら戻る）
  {"type": "load_scenario", "path": "episodes/episode_01", "new_page_after_return": true},

  // 回想モード開始（グレースケール）
  {"type": "flashback_start"},

  // 回想モード終了
  {"type": "flashback_end"},

  // エピソードクリア記録
  {"type": "episode_clear", "id": "ep_1"}
]
```

#### 記法のルール
- `new_page: true` → 新しいページで表示
- `go_next: true` → テキスト表示後に自動で次へ進む（ページ区切りの直前に使う）
- `index` と `jump` で選択肢の分岐と合流を管理
- `load_scenario` でエピソードを呼び出し、終わったら元に戻る
- `flashback_start/end` でエピソード内のグレースケールを管理

### 未実装・今後の課題
- ep_6「沢蟹」のエピソード本体
- 10月12日のシーン
- ep_3, ep_4の呼び出し場所
- ep_0からep_0_βへの切り替え仕組み
- バッドエンド
- 童歌の音声・再生
- エンディング後のマル秘ストーリー（実在する少年の真実）

---

## 6. 開発のルール

### シナリオの書き方（重要）
- 主人公は声を出してはいけない（現在時点のシーン）
- 過去のエピソード内では声を出してOK
- 手話を知っている人との会話では「伝えた」「応えた」と書く（ミスリード）
- お寺さんとの会話では頷くだけ
- 霊体を出すかどうかは意図的に使い分ける

### エピソード後の描写の規則
- エピソード後は必ず「……。…………。………………。」で始まる（放心状態）
- 霊体を出すエピソードは、その後に霊体の描写を入れる
- 霊体を出さないエピソードは、温かい余韻で終わる